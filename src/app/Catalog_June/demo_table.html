<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
        <title>layui table</title>
        <link rel="stylesheet" type="text/css" href="/src/static/3rdLibs/layui-v2.4.5/css/layui.css">

        
        <style>

        </style>
        
    </head>
    <body>
        <h2>Table</h2>
        <div style="width: 82%;margin: auto;">
            <table id="demo" lay-filter="test"></table>
        </div>

        <button class="layui-btn" name="reload">刷新表格</button>
        <script src="/src/static//3rdLibs/layui-v2.4.5/layui.js"></script>
        <script>

            layui.use(['jquery', 'table', 'form'], function() {
                var $ = layui.$;
                var table = layui.table;
                var form = layui.form;
                function renderTable() {
                    table.render({
                        elem: '#demo', 
                        id: 'testReload',
                        height: 420,                    
                        url: '/src/app/data/table.txt',
                        //url: '../data/table.txt',
                        page: {                            
                            limit: sessionStorage.getItem('limit'),        // 从浏览器缓存获取
                            curr: location.hash.replace('#!fenye=', ''), //获取起始页
                            hash: 'fenye' //自定义hash值                            
                        },                       
                        cols: [
                            [
                                {field: 'id', title: 'ID', sort: true},
                                {field: 'username', title: '用户名'},
                                {field: 'sex', title: '性别',sort: true},
                                {field: 'city', title: '城市'},
                                {field: 'sign', title: '签名'},
                                {field: 'experience', title: '积分', sort: true},
                                {field: 'score', title: '评分', sort: true},
                                {field: 'classify', title: '职业'},
                                {field: 'wealth', title: '财富', sort: true} 
                            ]
                        ],
                        done: function(res, curr, count) {
                            var limit = $(".layui-laypage-limits").find('select').val();
                            sessionStorage.setItem('limit', limit); // 保存在浏览器
                        }
                    });
                }
                
                renderTable(); 
                
                $(".layui-laypage-limits").on('change', 'select', function() {
                    console.log("AAA");
                });               

            });



        </script>
    </body>
</html>